module circular-liveness-rewrites

imports
  libstratego-lib
  circular-liveness

strategies

  main-circular-liveness-rewrites =
    option-wrap(
      verbose-option
    ,
      make-input;
      id.debug => [Assign("x","value"), While("x", [Assign("x","value")]), Return("x")]
    )
  
rules

  eq [assign | s*] -> s* where assign.is-dead

attributes

  local is-dead = not(<id.diff> (id.defines, id.live-after) => [])

attributes // HACK: different main files and imports in the same directory don't work too well
  
  local defines    := id where fail
  local live-after := id where fail
  
